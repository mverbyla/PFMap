lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
fits <- data.frame(intercept,slope,n,r2)
fits
fits <- data.frame(intercept,slope,n,r2)
fits <- data.frame(intercept=rep(NA,length(microbes)),slope=rep(NA,length(microbes)),n=rep(NA,length(microbes)),r2=rep(NA,length(microbes)))
fits
rownames(fits) <- microbes
fits
par(mfrow = c(1, 1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[[i]]$intercept<-coefficients(fit)[[1]]
fits[[i]]$slope<-coefficients(fit)[[2]]
fits[[i]]$n<-length(temp$log10_reduction)
fits[[i]]$r2<-summary(fit)$r.squared
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
fits <- data.frame(intercept=rep(NA,length(microbes)),slope=rep(NA,length(microbes)),n=rep(NA,length(microbes)),r2=rep(NA,length(microbes)))
rownames(fits) <- microbes
par(mfrow = c(1, 1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"intercept"]<-coefficients(fit)[[1]]
fits[i,"slope"]<-coefficients(fit)[[2]]
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-summary(fit)$r.squared
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
fits <- data.frame(intercept=rep(NA,length(microbes)),slope=rep(NA,length(microbes)),n=rep(NA,length(microbes)),r2=rep(NA,length(microbes)))
rownames(fits) <- microbes
par(mfrow = c(1, 1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
fits <- data.frame(slope=rep(NA,length(microbes)),intercept=rep(NA,length(microbes)),n=rep(NA,length(microbes)),r2=rep(NA,length(microbes)))
rownames(fits) <- microbes
par(mfrow = c(1, 1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
require(ggplot2)
ggplot(df1,aes(ltime,temperature_celsius))+geom_point(aes(color=matrix2,shape=microbial_group2))
microbes<-unique(df1$microbial_group1)
fits <- data.frame(slope=rep(NA,length(microbes)),intercept=rep(NA,length(microbes)),n=rep(NA,length(microbes)),r2=rep(NA,length(microbes)))
rownames(fits) <- microbes
par(mfrow = c(1, 1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
microbes[i]
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.1, 0.1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.1, 0.1),bty='n')
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.2, 0.1),bty='n')
microbes<-unique(df1$microbial_group1)
fits <- data.frame(slope=rep(NA,length(microbes)),intercept=rep(NA,length(microbes)),n=rep(NA,length(microbes)),r2=rep(NA,length(microbes)))
rownames(fits) <- microbes
par(mfrow = c(1, 1))
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.1, 0.01*i),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.1, 0.1*i),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.1, 0.05*i),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.05, 0.05*i-1),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.05, 0.05*i),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.05, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(df1$time_hours,df1$temperature_celsius,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95))
colors=rainbow(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i])
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=terrain.colors(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
colors=heat.colors(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
colors=topo.colors(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
colors=cm.colors(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
colors=viridis(length(microbes))
library(viridisLite)
colors=viridis(length(microbes))
colors
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=1,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=viridis(length(microbes))
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
library(RColorBrewer)
colors=paired(length(microbes))
colors=brewer.pal(length(microbes),'paired')
colors=brewer.pal(length(microbes),paired)
colors=brewer.pal(length(microbes),'Paired')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
colors=brewer.pal(length(microbes),'YlOrRd')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
colors=brewer.pal(length(microbes),'Spectral')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
par(mfrow = c(1, 1))
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=brewer.pal(length(microbes),'Spectral')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
i=3
microbes
i=7
temp<-df1[df1$microbial_group1==microbes[i],]
temp
fits[i,"r2"]
fits[i,"r2"]>0.7
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=brewer.pal(length(microbes),'Spectral')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4 & fits[i,"r2"]>0.7){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=brewer.pal(length(microbes),'Spectral')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4 & fits[i,"r2"]>0.6){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
fits
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=brewer.pal(length(microbes),'Spectral')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.95)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4 & fits[i,"r2"]>0.5){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
plot(-100,-100,log='x',xlab="Time (hours)",ylab="Temperature (°C)",ylim=c(0,95),xlim=c(0.0001,10000))
colors=brewer.pal(length(microbes),'Spectral')
for(i in 1:length(microbes)){
temp<-df1[df1$microbial_group1==microbes[i],]
fit<-lm(ltime~temperature_celsius,data=temp)
fits[i,"slope"]<-round(coefficients(fit)[[2]],3)
fits[i,"intercept"]<-round(coefficients(fit)[[1]],3)
fits[i,"n"]<-length(temp$log10_reduction)
fits[i,"r2"]<-round(summary(fit)$r.squared,3)
newd<-data.frame(temperature_celsius=seq(min(temp$temperature_celsius),max(temp$temperature_celsius),by=0.5))
pre<-data.frame(exp(predict(fit,newdata=newd,interval="prediction",level=0.9)))
lines(temp$time_hours,temp$temperature_celsius,type='p',col=colors[i],pch=i)
legend("bottomleft",legend = microbes[i],col=colors[i],pch=i,text.col = "black",horiz = F,inset = c(0.02, 0.05*i-0.05),bty='n')
if(length(temp$log10_reduction)>=4 & fits[i,"r2"]>0.5){
lines(pre$fit,newd$temperature_celsius,type='l',lty=2,col=colors[i])
lines(pre$upr,newd$temperature_celsius,type='l',lty=3,col=colors[i])
}
}
